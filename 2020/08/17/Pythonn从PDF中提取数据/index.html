<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Pythonn从PDF中提取数据 | Gang Li's Personal Website</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><script class="js-hypothesis-config" type="application/json">{"showHighlights": true}</script><script src="https://hypothes.is/embed.js" async=""></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.0.2"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Pythonn从PDF中提取数据</h1><a id="logo" href="/.">Gang Li's Personal Website</a><p class="description">Causal Inference, Python, Stata, LaTeX, Zotero</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tag/"><i class="fa fa-tag"> 标签</i></a><a href="/shuoshuo/"><i class="fa fa-cloud"> 零思</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Pythonn从PDF中提取数据</h1><div class="post-meta">2020-08-17<span> | </span><span class="category"><a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.8k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 8</span><span class="post-meta-item-text"> 分钟</span></span></span></div><a class="disqus-comment-count" href="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/#vcomment"><span class="valine-comment-count" data-xid="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/"></span><span> 条评论</span></a><div class="post-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>PDF(<strong>P</strong>ortable <strong>D</strong>ocument <strong>F</strong>ormat)，译作便携式文档格式，是一种用独立于应用程序、硬件、操作系统的方式呈现文档的文件格式。PDF文件通常混合了矢量图形、文本和位图，其基本内容包括：文本存储为内容字符串、由图形和线条组成的用于说明和设计的矢量图形、由照片和其他类型的图片组成的位图。这是 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%96%87%E6%A1%A3%E6%A0%BC%E5%BC%8F">维基百科-PDF</a> 的解释。</p>
<p>结合自己的经验，我觉得常见的PDF文件可以分为两类：一种是文本转化而成（Text-Based），这种文件通常可以直接复制和粘贴；另一种是扫描文件而成（Scanned），比如影印书籍、插入图片制成的文件。依据这个划分，将 Python 中处理 PDF 文件的第三方库可以简单归类：</p>
<ul>
<li><strong>Text-Based</strong>：<code>PyPDF2</code>,<code>pdfminer</code>,<code>textract</code>,<code>slate</code> 等库可用于提取文本；<code>pdfplumber</code>,<code>camelot</code> 等库可用来提取表格。</li>
<li><strong>Scanned</strong>：先将文档转为图片，再利用 OCR（光学字符识别）提取内容，如 <code>pytesseract</code> 库；或者采用 <code>OpenCV</code> 进行图像处理。</li>
</ul>
<p>上述大部分是第三方库，所以需要先进行安装：</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">pip install PyPDF2</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdfminer</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdfminer.six</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install textract</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install slate</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdfplumber</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install camelot</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdf2image</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pillow</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pytesseract</span></span><br></pre></td></tr></table></figure>
<p> 接下来，我们就分别使用上面提到的方法，分别看看对两类文档的处理。</p>
<h1 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h1><h2 id="Text-Based-PDF"><a href="#Text-Based-PDF" class="headerlink" title="Text-Based PDF"></a>Text-Based PDF</h2><h3 id="PyPDF2-库"><a href="#PyPDF2-库" class="headerlink" title="PyPDF2 库"></a>PyPDF2 库</h3><p> <code>PyPDF2</code>拥有<code>PdfFileReader</code>, <code>PdfFileMerger</code>,<code>PageObject</code>和<code>PdfFileWriter</code> 四个类，能够完成 PDF 读取、拆分、裁剪和合并等工作。</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取 PDF 信息</span></span><br><span class="line">pdfFile = open(<span class="string">&#x27;./input/2020中央一号文件.pdf&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">pdfText = PyPDF2.PdfFileReader(pdfFile)</span><br><span class="line">page_count = pdfText.getNumPages()  <span class="comment"># 获取页面总数</span></span><br><span class="line">print(page_count)  <span class="comment"># 共 19 页</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取文本</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> range(<span class="number">0</span>, page_count):</span><br><span class="line">    text = pdfText.getPage(p)</span><br><span class="line">    print(text.extractText().encode(<span class="string">&#x27;utf-8&#x27;</span>))  </span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 部分输出：</span></span><br><span class="line"><span class="string">b&#x27;\n \n\n \n\n \n\n2020\n\n1\n\n2\n\n \n  \n\n\n\n\n \n  \n2020\n\n\n\n\n\n\n\n2020\n\n\n \n  \n\n2020\n\n\n\n\n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\n\n\n\n\n\n \n  \n\n \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;  \n\n\n\n\n\n\n\n\n\n \n  \n\n\n\n\n\n\n\n\n \n  \n\n\n\n\n\n\n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\n\n \n  \n\n\n\n\n\n\n\n\n \n  \n\n\n \n  \n\n\n\n\n\n\n\n\n\n&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>上面文件提取输出为空，猜想是因为和文件本身有关，识别不了。于是，我换了另外一个英文论文用来测试。</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/1.png" alt></p>
<p>测试代码和输出结果如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更换另外的英文PDF</span></span><br><span class="line">pdfFile = open(<span class="string">&#x27;./input/Political Uncertainty and Corporate Investment Cycles.pdf&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">pdfObj = PyPDF2.PdfFileReader(pdfFile)</span><br><span class="line">page_count = pdfObj.getNumPages()</span><br><span class="line">print(page_count)</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> range(<span class="number">0</span>, page_count):</span><br><span class="line">    text = pdfObj.getPage(p)</span><br><span class="line">    print(text.extractText())</span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 部分输出：</span></span><br><span class="line"><span class="string">39</span></span><br><span class="line"><span class="string">THEJOURNALOFFINANCE</span></span><br><span class="line"><span class="string">•</span></span><br><span class="line"><span class="string">VOL.LXVII,NO.1</span></span><br><span class="line"><span class="string">•</span></span><br><span class="line"><span class="string">FEBRUARY2012</span></span><br><span class="line"><span class="string">PoliticalUncertaintyandCorporateInvestment</span></span><br><span class="line"><span class="string">Cycles</span></span><br><span class="line"><span class="string">BRANDONJULIOandYOUNGSUKYOOK</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ABSTRACT</span></span><br><span class="line"><span class="string">Wedocumentcyclesincorporateinvestmentcorrespondingwiththetimingofna-</span></span><br><span class="line"><span class="string">tionalelectionsaroundtheworld.Duringelectionyears,Þrmsreduceinvestmentex-</span></span><br><span class="line"><span class="string">pendituresbyanaverageof4.8%relativetononelectionyears,controllingforgrowth</span></span><br><span class="line"><span class="string">opportunitiesandeconomicconditions.Themagnitudeoftheinvestmentcyclesvaries</span></span><br><span class="line"><span class="string">withdifferentcountryandelectioncharacteristics.Weinvestigateseveralpotential</span></span><br><span class="line"><span class="string">explanationsandÞndevidencesupportingthehypothesisthatpoliticaluncertainty</span></span><br><span class="line"><span class="string">leadsÞrmstoreduceinvestmentexpendituresuntiltheelectoraluncertaintyisre-</span></span><br><span class="line"><span class="string">solved.TheseÞndingssuggestthatpoliticaluncertaintyisanimportantchannel</span></span><br><span class="line"><span class="string">throughwhichthepoliticalprocessaffectsrealeconomicoutcomes.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="pdfminer-库"><a href="#pdfminer-库" class="headerlink" title="pdfminer 库"></a>pdfminer 库</h3><p><code>pdfminer</code> 库主要用于解析PDF，因为版本更新的原因，这个库的配置过程坑略多。可以参阅 stackoverflow 上 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5725278/how-do-i-use-pdfminer-as-a-library#">How do I use pdfminer as a library
</a> 的回答，提供了一些解决方案。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFResourceManager, PDFPageInterpreter</span><br><span class="line"><span class="keyword">from</span> pdfminer.converter <span class="keyword">import</span> TextConverter</span><br><span class="line"><span class="keyword">from</span> pdfminer.layout <span class="keyword">import</span> LAParams</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfpage <span class="keyword">import</span> PDFPage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_pdf_to_txt</span>(<span class="params">path</span>):</span></span><br><span class="line">    rsrcmgr = PDFResourceManager()  <span class="comment"># 存储共享资源，例如字体或图片</span></span><br><span class="line">    retstr = io.StringIO()</span><br><span class="line">    codec = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    laparams = LAParams()</span><br><span class="line">    device = TextConverter(rsrcmgr, retstr, codec=codec, laparams=laparams)</span><br><span class="line">    fp = open(path, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    interpreter = PDFPageInterpreter(rsrcmgr, device)  <span class="comment"># 解析 page内容</span></span><br><span class="line">    password = <span class="string">&quot;&quot;</span>  <span class="comment"># 密码，若无则初始化为空</span></span><br><span class="line">    maxpages = <span class="number">0</span></span><br><span class="line">    caching = <span class="literal">True</span></span><br><span class="line">    pagenos = set()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> PDFPage.get_pages(fp, pagenos, maxpages=maxpages,</span><br><span class="line">                                  password=password,</span><br><span class="line">                                  caching=caching,</span><br><span class="line">                                  check_extractable=<span class="literal">True</span>):</span><br><span class="line">        interpreter.process_page(page)</span><br><span class="line"></span><br><span class="line">    text = retstr.getvalue()</span><br><span class="line"></span><br><span class="line">    fp.close()</span><br><span class="line">    device.close()</span><br><span class="line">    retstr.close()</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">convert_pdf_to_txt(<span class="string">&quot;./input/2020中央一号文件.pdf&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>输出效果如下：</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/2.png" alt></p>
<h3 id="textract-库"><a href="#textract-库" class="headerlink" title="textract 库"></a>textract 库</h3><p>这个库用起来也比较方便，但配置需要注意两点：1.安装 <code>textract</code> 的时候并不会自动安装 <code>pdfminer</code>，需要手动安装 <code>pdfminer</code>；2. 报错 <code>local variable &#39;pipe&#39; referenced before assignment</code>，需要对源码进行细微修改。如果配置报错，可以参考这篇文章： <a target="_blank" rel="noopener" href="https://blog.csdn.net/FannLann/article/details/80238889">python使用textract解析pdf时遇到UnboundLocalError: local variable ‘pipe’ referenced before assignment</a>，总结的比较全面。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> textract</span><br><span class="line">text = textract.process(<span class="string">&quot;./input/2020中央一号文件.pdf&quot;</span>, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">print(text.decode())</span><br></pre></td></tr></table></figure>
<p>处理效果如下：</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/3.png" alt></p>
<h2 id="Scanned-PDF"><a href="#Scanned-PDF" class="headerlink" title="Scanned PDF"></a>Scanned PDF</h2><blockquote>
<p>Python-tesseract is an optical character recognition (OCR) tool for python. That is, it will recognize and “read” the text embedded in images. Python-tesseract is a wrapper for Google’s Tesseract-OCR Engine. It is also useful as a stand-alone invocation script to tesseract, as it can read all image types supported by the Pillow and Leptonica imaging libraries, including jpeg, png, gif, bmp, tiff, and others. Additionally, if used as a script, Python-tesseract will print the recognized text instead of writing it to a file.(from pytesseract project description)</p>
</blockquote>
<p> 上段引用来自 <code>pytesseract</code> 项目的官方描述。说的是：Python-tesseract 是 Google Tesseract-OCR 引擎的包装。它也可以用作tesseract的独立调用脚本，因为它可以读取 Pillow 和 Leptonica 图像库支持的所有图像类型，包括 jpeg，png，gif，bmp，tiff 等。<strong>此外，如果用作脚本，Python-tesseract 将打印可识别的文本，而不是将其写入文件</strong>。以我最近在在看的一本电子书（奈特的《风险、不确定性和利润》）进行演示，文档的清晰度如下：</p>
<p> <img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/4.png" alt></p>
<p>对于这种扫描的文件，处理方法前言中已经提及。具体来说：先将 PDF 转换为图片，再利用 OCR 提取文本内容。另外，因为全书有 320 页，处理起来太费时间，我就先提取其中的 15-30 页（正好是作者序言）进行演示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2</span><br><span class="line"><span class="keyword">from</span> pdf2image <span class="keyword">import</span> convert_from_path</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切割、提取15-30页</span></span><br><span class="line">pdfFile = open(<span class="string">&#x27;./input/风险、不确定性和利润.pdf&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">pdf_input = PyPDF2.PdfFileReader(pdfFile)</span><br><span class="line"></span><br><span class="line">pdf_output = PyPDF2.PdfFileWriter()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span>, <span class="number">30</span>):</span><br><span class="line">    pdf_output.addPage(pdf_input.getPage(i))</span><br><span class="line">pdf_output.write(open(<span class="string">&#x27;./output/风险、不确定性和利润_15_30.pdf&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>))</span><br><span class="line"><span class="comment"># PDF 转为图片</span></span><br><span class="line">PDF_file = <span class="string">&#x27;./output/风险、不确定性和利润_15_30.pdf&#x27;</span></span><br><span class="line">pages = convert_from_path(PDF_file, <span class="number">500</span>)</span><br><span class="line">image_counter = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> page <span class="keyword">in</span> pages:</span><br><span class="line">    filename = <span class="string">&quot;page_&quot;</span>+str(image_counter)+<span class="string">&quot;.jpg&quot;</span></span><br><span class="line">    page.save(filename, <span class="string">&#x27;JPEG&#x27;</span>)</span><br><span class="line">    image_counter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图片中提取文本</span></span><br><span class="line">filelimit = image_counter<span class="number">-1</span></span><br><span class="line">outfile = <span class="string">&quot;out_text.txt&quot;</span></span><br><span class="line">f = open(outfile, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, filelimit + <span class="number">1</span>):</span><br><span class="line">    filename = <span class="string">&quot;page_&quot;</span>+str(i)+<span class="string">&quot;.jpg&quot;</span></span><br><span class="line">    text = str(</span><br><span class="line">        ((pytesseract.image_to_string(Image.open(filename), lang=<span class="string">&#x27;chi_sim&#x27;</span>)))) // chi_sim 表示简体中文</span><br><span class="line">    text = text.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    text = text.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    f.write(text)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>处理结果如下：</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/5.png" alt></p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>本文对 Python 中从 PDF 提取信息的方法进行了说明，并将主要第三方库进行了对比。可以看出，PDF的转换是一个比较麻烦的事，转换效果很大程度取决于文档本身的质量。如果文件量比较小，还不如复制粘贴，或者 使用 APP 和网站处理来得快。任务量比较大，实在需要程序处理时，一方面，在着手写程序之前先可以使用不同的方法对比，选择最好的实现效果；另一方面，使用程序批量处理并非一劳永逸，往往需要和人工校验相配合。</p>
<h1 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h1><p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/working-with-pdf-files-in-python/">Working with PDF files in Python</a></p>
<p> <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/136888486">PDF提取文本</a></p>
<p><a target="_blank" rel="noopener" href="https://www.blog.pythonlibrary.org/2018/05/03/exporting-data-from-pdfs-with-python/">Exporting Data from PDFs with Python</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42415326/article/details/89432839?utm_medium=distribute.pc_relevant.none-task-blog-baidujs-8">使用pdfminer3k模块读取PDF</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5725278/how-do-i-use-pdfminer-as-a-library#">How do I use pdfminer as a library
</a></p>
</div><div id="donate"><link rel="stylesheet" type="text/css" href="/css/donate.css"><script type="text/javascript" src="/js/donate.js" successtext="复制成功!"></script><a class="pos-f tr3" id="github" target="_blank" rel="noopener" href="https://github.com/Kaiyuan/donate-page" arget="_blank" title="Github"></a><div id="DonateText">Donate</div><ul class="list pos-f" id="donateBox"><li id="AliPay" qr="/img/alipayQR.jpg"></li><li id="WeChat" qr="/img/wechatQR.jpg"></li></ul><div class="pos-f left-100" id="QRBox"><div id="MainBox"></div></div></div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css"><p><span>本文标题：</span>Pythonn从PDF中提取数据</p><p><span>文章作者：</span>Gang Li</p><p><span>发布时间：</span>2020-08-17</p><p><span>最后更新：</span>2021-04-13</p><p><span>原始链接：</span><a href="/2020/08/17/Pythonn从PDF中提取数据/">http://lgspace.top/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="http://lgspace.top/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/"></i></span></p><p><span>版权声明：</span>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</p></div><br><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="http://lgspace.top/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/" data-id="cl4l32rn8003dhpor579pd5dc" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADI0lEQVR42u3awY7iQAwE0Pn/n56V9rTSCqiyg0SalxOCzNDPOZh29c9PfP3+vf59/eh6/reP3snv/P+7Hv23Cy5sbGzsm7ATxvPXj9j5Xz3nPV/V8JFgY2NjH8dOmtasCeV9ZHZn0sywsbGxsfdfOdtCtI8EGxsbG3vTGJItSr79SEZIeSmxsbGxv4E9G99cNTzal/KNszRsbGzsj2fPgt7PfP32fBsbGxv7w9i/o2sWJLRbiDbELdaPjY2NfRC7jVrbzUYSGGw+nQ2YsLGxsU9lX/UrfXbnVWOmohDY2NjYR7Bnw/Q8xH2+iLahbmIGbGxs7LPZsy9rm1Pb2PZxRXRGCRsbG/sI9iwMyMdJ+dYiaT+ztRV9GxsbG/tW7Fkcu2lXs/bZRsvD4zvY2NjYN2fnTWJ/ZOfaMVP7kLCxsbFPZW9GPLPxUx4S7+9/WAJsbGzsg9j7EU97Vmg/0sqL/uIRYmNjY9+WnbeZTUOaxbH5O/UhHmxsbOxD2bMmkRerDSTaAKAICbCxsbEPZbdbgrYcs5HTrK1iY2Njfw97H6nmsPy/bYZWbdiMjY2NfXd2UpWrRjmbCLkt34vHiY2NjX0Qu/04L8dsoZuwoV0bNjY29hnsZASfj+nbsf7+GNBwPdjY2NgHsdvl5gHwZnPSfprjsbGxsb+BnYep7RJnG5U2VC6GVtjY2NhHsPMR0mb7MYscZsOmSIGNjY19NPsdR2Tysu7BUXiMjY2NfRA7oebhQdJC2g1GO4QqHgA2Njb20ezZQZm8RW1KsN8IYWNjY5/HzpFFjDpqjUmJ87giP9yDjY2NfR77quM7LWDWnPINUhH9YmNjY9+QPTtM0wYDbbuqh/553IuNjY19BHv2U74NhvPf/7MQtx4/YWNjYx/E3vS9vOW0RWy3E22hsbGxsc9jt00rGSolBZqNn2Z3Rvk2NjY29s3ZszFTS8o7Z74VWY2WsLGxsb+YnS9leCByHSe8KBw2Njb2V7Jn4/7N4Zsc1kbO2NjY2Oex241EHrvmA6B8YJSPtB6+j42NjX0QezbiyTcb+eBpFgC0YTM2Njb2Qew/6K5PAiZkI8sAAAAASUVORK5CYII=">分享</a><div class="tags"><a href="/tags/Python/"><i class="fa fa-tag"></i>Python</a><a href="/tags/%E5%B7%A5%E5%85%B7/"><i class="fa fa-tag"></i>工具</a></div><div class="post-nav"><a class="pre" href="/2020/08/17/Python%E5%81%9A%E5%A4%9A%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/">Python做多元线性回归</a><a class="next" href="/2020/08/17/PythonforResearch-2-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/">PythonforResearch|2_数据处理</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == 'true' ? true : false;
var verify = 'false' == 'true' ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'4r3jOS497uyoVjem8hrofuye-MdYXbMMI',
  appKey:'dRzNUi4hOYKfUV95GTwK8hoH',
  placeholder:'给我留言吧～',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'7'
})
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"/><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script><div class="aplayer" data-id="7044223387" data-server="netease" data-type="playlist" data-listmaxheight="98px" data-theme="#555555"></div></div><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a><span class="category-list-count">66</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a><span class="category-list-count">6</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/%E5%BE%AE%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">微观经济学</a> <a href="/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">课程笔记</a> <a href="/tags/HUST/" style="font-size: 15px;">HUST</a> <a href="/tags/Data/" style="font-size: 15px;">Data</a> <a href="/tags/Casual-Inference/" style="font-size: 15px;">Casual Inference</a> <a href="/tags/%E6%96%87%E7%8C%AE/" style="font-size: 15px;">文献</a> <a href="/tags/%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">经济学</a> <a href="/tags/%E5%8F%91%E5%B1%95%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">发展经济学</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">笔记</a> <a href="/tags/%E8%AE%A1%E9%87%8F/" style="font-size: 15px;">计量</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 15px;">工具</a> <a href="/tags/%E6%96%87%E4%BB%B6/" style="font-size: 15px;">文件</a> <a href="/tags/IELTS/" style="font-size: 15px;">IELTS</a> <a href="/tags/Jupyter-Notebook/" style="font-size: 15px;">Jupyter Notebook</a> <a href="/tags/%E5%AE%8F%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">宏观经济学</a> <a href="/tags/%E6%95%B0%E6%8D%AE/" style="font-size: 15px;">数据</a> <a href="/tags/%E5%8F%B6%E8%88%AA/" style="font-size: 15px;">叶航</a> <a href="/tags/Mankin/" style="font-size: 15px;">Mankin</a> <a href="/tags/Stata/" style="font-size: 15px;">Stata</a> <a href="/tags/%E7%94%B5%E5%BD%B1/" style="font-size: 15px;">电影</a> <a href="/tags/%E8%A7%82%E5%90%8E%E6%84%9F/" style="font-size: 15px;">观后感</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/" style="font-size: 15px;">数据管理</a> <a href="/tags/Zotero/" style="font-size: 15px;">Zotero</a> <a href="/tags/%E7%BE%8E%E9%A3%9F/" style="font-size: 15px;">美食</a> <a href="/tags/LaTeX/" style="font-size: 15px;">LaTeX</a> <a href="/tags/%E8%8B%B1%E8%AF%AD/" style="font-size: 15px;">英语</a> <a href="/tags/%E8%80%83%E5%8D%9A/" style="font-size: 15px;">考博</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/06/19/Romer-Textbook-Cross-Country-Income-Difference/">第四章 跨国收入差距</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/29/Zotero-for-Windows-%E5%85%A8%E5%B1%80%E5%BC%95%E7%94%A8/">Zotero for Windows 全局引用</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/18/empirical-data-management/">实证研究数据管理规范化</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/23/MacroEcon-Data-Sources/">宏观经济常用数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/14/Advanced-MicroEcon-Notes-1/">高微II课程笔记-01</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/28/Exporting-Data-from-PDFs/">从 PDF 文件提取文本内容</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/22/Markdown-Typora-Brief-Intro/">Markdown-Typora-Brief-Intro</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/MacroEcon-Mankin-DynamicAD-AS/">MacroEcon-Mankin-DynamicAD-AS</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/20/DevelopEcon-ZhangPeiGang-Notes/">公平与发展</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/20/MacroEcon-Models/">MacroEcon-Models</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://magi.com/" title="magi 搜索" target="_blank">magi 搜索</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2022 <a href="/." rel="nofollow">Gang Li's Personal Website.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="0,0,0" opacity="0.5" zIndex="-2" count="50" src="//cdn.jsdelivr.net/npm/canvas-nest.js/dist/canvas-nest.min.js"></script><script type="text/javascript" src="/js/love.js"></script><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script><script>(function(d) {
  var config = {
    kitId: 'qpn2tap',
    scriptTimeout: 3000,
    async: true
  },
  h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
})(document);</script></div></body></html>
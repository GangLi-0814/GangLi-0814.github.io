<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言PDF(Portable Document Format)，译作便携式文档格式，是一种用独立于应用程序、硬件、操作系统的方式呈现文档的文件格式。PDF文件通常混合了矢量图形、文本和位图，其基本内容包括：文本存储为内容字符串、由图形和线条组成的用于说明和设计的矢量图形、由照片和其他类型的图片组成的位图。这是 维基百科-PDF 的解释。 结合自己的经验，我觉得常见的PDF文件可以分为两类：一种是">
<meta property="og:type" content="article">
<meta property="og:title" content="Pythonn从PDF中提取数据">
<meta property="og:url" content="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/index.html">
<meta property="og:site_name" content="LG&#39;s Blog">
<meta property="og:description" content="前言PDF(Portable Document Format)，译作便携式文档格式，是一种用独立于应用程序、硬件、操作系统的方式呈现文档的文件格式。PDF文件通常混合了矢量图形、文本和位图，其基本内容包括：文本存储为内容字符串、由图形和线条组成的用于说明和设计的矢量图形、由照片和其他类型的图片组成的位图。这是 维基百科-PDF 的解释。 结合自己的经验，我觉得常见的PDF文件可以分为两类：一种是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/1.png">
<meta property="og:image" content="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/2.png">
<meta property="og:image" content="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/3.png">
<meta property="og:image" content="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/4.png">
<meta property="og:image" content="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/5.png">
<meta property="article:published_time" content="2020-08-17T04:32:02.000Z">
<meta property="article:modified_time" content="2020-08-17T06:01:26.000Z">
<meta property="article:author" content="Gang Li">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/1.png">

<link rel="canonical" href="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Pythonn从PDF中提取数据 | LG's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">LG's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Gang Li">
      <meta itemprop="description" content="微信公众号: PyStaData">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LG's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Pythonn从PDF中提取数据
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-17 12:32:02 / 修改时间：14:01:26" itemprop="dateCreated datePublished" datetime="2020-08-17T12:32:02+08:00">2020-08-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <script src="/assets/js/APlayer.min.js"> </script><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>PDF(<strong>P</strong>ortable <strong>D</strong>ocument <strong>F</strong>ormat)，译作便携式文档格式，是一种用独立于应用程序、硬件、操作系统的方式呈现文档的文件格式。PDF文件通常混合了矢量图形、文本和位图，其基本内容包括：文本存储为内容字符串、由图形和线条组成的用于说明和设计的矢量图形、由照片和其他类型的图片组成的位图。这是 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%96%87%E6%A1%A3%E6%A0%BC%E5%BC%8F">维基百科-PDF</a> 的解释。</p>
<p>结合自己的经验，我觉得常见的PDF文件可以分为两类：一种是文本转化而成（Text-Based），这种文件通常可以直接复制和粘贴；另一种是扫描文件而成（Scanned），比如影印书籍、插入图片制成的文件。依据这个划分，将 Python 中处理 PDF 文件的第三方库可以简单归类：</p>
<ul>
<li><strong>Text-Based</strong>：<code>PyPDF2</code>,<code>pdfminer</code>,<code>textract</code>,<code>slate</code> 等库可用于提取文本；<code>pdfplumber</code>,<code>camelot</code> 等库可用来提取表格。</li>
<li><strong>Scanned</strong>：先将文档转为图片，再利用 OCR（光学字符识别）提取内容，如 <code>pytesseract</code> 库；或者采用 <code>OpenCV</code> 进行图像处理。</li>
</ul>
<p>上述大部分是第三方库，所以需要先进行安装：</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">pip install PyPDF2</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdfminer</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdfminer.six</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install textract</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install slate</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdfplumber</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install camelot</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pdf2image</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pillow</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pip install pytesseract</span></span><br></pre></td></tr></table></figure>
<p> 接下来，我们就分别使用上面提到的方法，分别看看对两类文档的处理。</p>
<h1 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h1><h2 id="Text-Based-PDF"><a href="#Text-Based-PDF" class="headerlink" title="Text-Based PDF"></a>Text-Based PDF</h2><h3 id="PyPDF2-库"><a href="#PyPDF2-库" class="headerlink" title="PyPDF2 库"></a>PyPDF2 库</h3><p> <code>PyPDF2</code>拥有<code>PdfFileReader</code>, <code>PdfFileMerger</code>,<code>PageObject</code>和<code>PdfFileWriter</code> 四个类，能够完成 PDF 读取、拆分、裁剪和合并等工作。</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取 PDF 信息</span></span><br><span class="line">pdfFile = open(<span class="string">&#x27;./input/2020中央一号文件.pdf&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">pdfText = PyPDF2.PdfFileReader(pdfFile)</span><br><span class="line">page_count = pdfText.getNumPages()  <span class="comment"># 获取页面总数</span></span><br><span class="line">print(page_count)  <span class="comment"># 共 19 页</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取文本</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> range(<span class="number">0</span>, page_count):</span><br><span class="line">    text = pdfText.getPage(p)</span><br><span class="line">    print(text.extractText().encode(<span class="string">&#x27;utf-8&#x27;</span>))  </span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 部分输出：</span></span><br><span class="line"><span class="string">b&#x27;\n \n\n \n\n \n\n2020\n\n1\n\n2\n\n \n  \n\n\n\n\n \n  \n2020\n\n\n\n\n\n\n\n2020\n\n\n \n  \n\n2020\n\n\n\n\n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\n\n\n\n\n\n \n  \n\n \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;  \n\n\n\n\n\n\n\n\n\n \n  \n\n\n\n\n\n\n\n\n \n  \n\n\n\n\n\n\n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\n\n \n  \n\n\n\n\n\n\n\n\n \n  \n\n\n \n  \n\n\n\n\n\n\n\n\n\n&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>上面文件提取输出为空，猜想是因为和文件本身有关，识别不了。于是，我换了另外一个英文论文用来测试。</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/1.png" alt></p>
<p>测试代码和输出结果如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更换另外的英文PDF</span></span><br><span class="line">pdfFile = open(<span class="string">&#x27;./input/Political Uncertainty and Corporate Investment Cycles.pdf&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">pdfObj = PyPDF2.PdfFileReader(pdfFile)</span><br><span class="line">page_count = pdfObj.getNumPages()</span><br><span class="line">print(page_count)</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> range(<span class="number">0</span>, page_count):</span><br><span class="line">    text = pdfObj.getPage(p)</span><br><span class="line">    print(text.extractText())</span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 部分输出：</span></span><br><span class="line"><span class="string">39</span></span><br><span class="line"><span class="string">THEJOURNALOFFINANCE</span></span><br><span class="line"><span class="string">•</span></span><br><span class="line"><span class="string">VOL.LXVII,NO.1</span></span><br><span class="line"><span class="string">•</span></span><br><span class="line"><span class="string">FEBRUARY2012</span></span><br><span class="line"><span class="string">PoliticalUncertaintyandCorporateInvestment</span></span><br><span class="line"><span class="string">Cycles</span></span><br><span class="line"><span class="string">BRANDONJULIOandYOUNGSUKYOOK</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ABSTRACT</span></span><br><span class="line"><span class="string">Wedocumentcyclesincorporateinvestmentcorrespondingwiththetimingofna-</span></span><br><span class="line"><span class="string">tionalelectionsaroundtheworld.Duringelectionyears,Þrmsreduceinvestmentex-</span></span><br><span class="line"><span class="string">pendituresbyanaverageof4.8%relativetononelectionyears,controllingforgrowth</span></span><br><span class="line"><span class="string">opportunitiesandeconomicconditions.Themagnitudeoftheinvestmentcyclesvaries</span></span><br><span class="line"><span class="string">withdifferentcountryandelectioncharacteristics.Weinvestigateseveralpotential</span></span><br><span class="line"><span class="string">explanationsandÞndevidencesupportingthehypothesisthatpoliticaluncertainty</span></span><br><span class="line"><span class="string">leadsÞrmstoreduceinvestmentexpendituresuntiltheelectoraluncertaintyisre-</span></span><br><span class="line"><span class="string">solved.TheseÞndingssuggestthatpoliticaluncertaintyisanimportantchannel</span></span><br><span class="line"><span class="string">throughwhichthepoliticalprocessaffectsrealeconomicoutcomes.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="pdfminer-库"><a href="#pdfminer-库" class="headerlink" title="pdfminer 库"></a>pdfminer 库</h3><p><code>pdfminer</code> 库主要用于解析PDF，因为版本更新的原因，这个库的配置过程坑略多。可以参阅 stackoverflow 上 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5725278/how-do-i-use-pdfminer-as-a-library#">How do I use pdfminer as a library
</a> 的回答，提供了一些解决方案。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFResourceManager, PDFPageInterpreter</span><br><span class="line"><span class="keyword">from</span> pdfminer.converter <span class="keyword">import</span> TextConverter</span><br><span class="line"><span class="keyword">from</span> pdfminer.layout <span class="keyword">import</span> LAParams</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfpage <span class="keyword">import</span> PDFPage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_pdf_to_txt</span>(<span class="params">path</span>):</span></span><br><span class="line">    rsrcmgr = PDFResourceManager()  <span class="comment"># 存储共享资源，例如字体或图片</span></span><br><span class="line">    retstr = io.StringIO()</span><br><span class="line">    codec = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    laparams = LAParams()</span><br><span class="line">    device = TextConverter(rsrcmgr, retstr, codec=codec, laparams=laparams)</span><br><span class="line">    fp = open(path, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    interpreter = PDFPageInterpreter(rsrcmgr, device)  <span class="comment"># 解析 page内容</span></span><br><span class="line">    password = <span class="string">&quot;&quot;</span>  <span class="comment"># 密码，若无则初始化为空</span></span><br><span class="line">    maxpages = <span class="number">0</span></span><br><span class="line">    caching = <span class="literal">True</span></span><br><span class="line">    pagenos = set()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> PDFPage.get_pages(fp, pagenos, maxpages=maxpages,</span><br><span class="line">                                  password=password,</span><br><span class="line">                                  caching=caching,</span><br><span class="line">                                  check_extractable=<span class="literal">True</span>):</span><br><span class="line">        interpreter.process_page(page)</span><br><span class="line"></span><br><span class="line">    text = retstr.getvalue()</span><br><span class="line"></span><br><span class="line">    fp.close()</span><br><span class="line">    device.close()</span><br><span class="line">    retstr.close()</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">convert_pdf_to_txt(<span class="string">&quot;./input/2020中央一号文件.pdf&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>输出效果如下：</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/2.png" alt></p>
<h3 id="textract-库"><a href="#textract-库" class="headerlink" title="textract 库"></a>textract 库</h3><p>这个库用起来也比较方便，但配置需要注意两点：1.安装 <code>textract</code> 的时候并不会自动安装 <code>pdfminer</code>，需要手动安装 <code>pdfminer</code>；2. 报错 <code>local variable &#39;pipe&#39; referenced before assignment</code>，需要对源码进行细微修改。如果配置报错，可以参考这篇文章： <a target="_blank" rel="noopener" href="https://blog.csdn.net/FannLann/article/details/80238889">python使用textract解析pdf时遇到UnboundLocalError: local variable ‘pipe’ referenced before assignment</a>，总结的比较全面。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> textract</span><br><span class="line">text = textract.process(<span class="string">&quot;./input/2020中央一号文件.pdf&quot;</span>, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">print(text.decode())</span><br></pre></td></tr></table></figure>
<p>处理效果如下：</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/3.png" alt></p>
<h2 id="Scanned-PDF"><a href="#Scanned-PDF" class="headerlink" title="Scanned PDF"></a>Scanned PDF</h2><blockquote>
<p>Python-tesseract is an optical character recognition (OCR) tool for python. That is, it will recognize and “read” the text embedded in images. Python-tesseract is a wrapper for Google’s Tesseract-OCR Engine. It is also useful as a stand-alone invocation script to tesseract, as it can read all image types supported by the Pillow and Leptonica imaging libraries, including jpeg, png, gif, bmp, tiff, and others. Additionally, if used as a script, Python-tesseract will print the recognized text instead of writing it to a file.(from pytesseract project description)</p>
</blockquote>
<p> 上段引用来自 <code>pytesseract</code> 项目的官方描述。说的是：Python-tesseract 是 Google Tesseract-OCR 引擎的包装。它也可以用作tesseract的独立调用脚本，因为它可以读取 Pillow 和 Leptonica 图像库支持的所有图像类型，包括 jpeg，png，gif，bmp，tiff 等。<strong>此外，如果用作脚本，Python-tesseract 将打印可识别的文本，而不是将其写入文件</strong>。以我最近在在看的一本电子书（奈特的《风险、不确定性和利润》）进行演示，文档的清晰度如下：</p>
<p> <img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/4.png" alt></p>
<p>对于这种扫描的文件，处理方法前言中已经提及。具体来说：先将 PDF 转换为图片，再利用 OCR 提取文本内容。另外，因为全书有 320 页，处理起来太费时间，我就先提取其中的 15-30 页（正好是作者序言）进行演示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2</span><br><span class="line"><span class="keyword">from</span> pdf2image <span class="keyword">import</span> convert_from_path</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切割、提取15-30页</span></span><br><span class="line">pdfFile = open(<span class="string">&#x27;./input/风险、不确定性和利润.pdf&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">pdf_input = PyPDF2.PdfFileReader(pdfFile)</span><br><span class="line"></span><br><span class="line">pdf_output = PyPDF2.PdfFileWriter()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span>, <span class="number">30</span>):</span><br><span class="line">    pdf_output.addPage(pdf_input.getPage(i))</span><br><span class="line">pdf_output.write(open(<span class="string">&#x27;./output/风险、不确定性和利润_15_30.pdf&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>))</span><br><span class="line"><span class="comment"># PDF 转为图片</span></span><br><span class="line">PDF_file = <span class="string">&#x27;./output/风险、不确定性和利润_15_30.pdf&#x27;</span></span><br><span class="line">pages = convert_from_path(PDF_file, <span class="number">500</span>)</span><br><span class="line">image_counter = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> page <span class="keyword">in</span> pages:</span><br><span class="line">    filename = <span class="string">&quot;page_&quot;</span>+str(image_counter)+<span class="string">&quot;.jpg&quot;</span></span><br><span class="line">    page.save(filename, <span class="string">&#x27;JPEG&#x27;</span>)</span><br><span class="line">    image_counter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图片中提取文本</span></span><br><span class="line">filelimit = image_counter<span class="number">-1</span></span><br><span class="line">outfile = <span class="string">&quot;out_text.txt&quot;</span></span><br><span class="line">f = open(outfile, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, filelimit + <span class="number">1</span>):</span><br><span class="line">    filename = <span class="string">&quot;page_&quot;</span>+str(i)+<span class="string">&quot;.jpg&quot;</span></span><br><span class="line">    text = str(</span><br><span class="line">        ((pytesseract.image_to_string(Image.open(filename), lang=<span class="string">&#x27;chi_sim&#x27;</span>)))) // chi_sim 表示简体中文</span><br><span class="line">    text = text.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    text = text.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    f.write(text)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>处理结果如下：</p>
<p><img src="/2020/08/17/Pythonn%E4%BB%8EPDF%E4%B8%AD%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE/5.png" alt></p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>本文对 Python 中从 PDF 提取信息的方法进行了说明，并将主要第三方库进行了对比。可以看出，PDF的转换是一个比较麻烦的事，转换效果很大程度取决于文档本身的质量。如果文件量比较小，还不如复制粘贴，或者 使用 APP 和网站处理来得快。任务量比较大，实在需要程序处理时，一方面，在着手写程序之前先可以使用不同的方法对比，选择最好的实现效果；另一方面，使用程序批量处理并非一劳永逸，往往需要和人工校验相配合。</p>
<h1 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h1><p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/working-with-pdf-files-in-python/">Working with PDF files in Python</a></p>
<p> <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/136888486">PDF提取文本</a></p>
<p><a target="_blank" rel="noopener" href="https://www.blog.pythonlibrary.org/2018/05/03/exporting-data-from-pdfs-with-python/">Exporting Data from PDFs with Python</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42415326/article/details/89432839?utm_medium=distribute.pc_relevant.none-task-blog-baidujs-8">使用pdfminer3k模块读取PDF</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5725278/how-do-i-use-pdfminer-as-a-library#">How do I use pdfminer as a library
</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"># Python</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/08/17/PythonforResearch-2-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" rel="prev" title="PythonforResearch|2_数据处理">
      <i class="fa fa-chevron-left"></i> PythonforResearch|2_数据处理
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/08/17/Python%E5%81%9A%E5%A4%9A%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" rel="next" title="Python做多元线性回归">
      Python做多元线性回归 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B"><span class="nav-number">2.</span> <span class="nav-text">实现过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Text-Based-PDF"><span class="nav-number">2.1.</span> <span class="nav-text">Text-Based PDF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PyPDF2-%E5%BA%93"><span class="nav-number">2.1.1.</span> <span class="nav-text">PyPDF2 库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pdfminer-%E5%BA%93"><span class="nav-number">2.1.2.</span> <span class="nav-text">pdfminer 库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#textract-%E5%BA%93"><span class="nav-number">2.1.3.</span> <span class="nav-text">textract 库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Scanned-PDF"><span class="nav-number">2.2.</span> <span class="nav-text">Scanned PDF</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">3.</span> <span class="nav-text">小结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB"><span class="nav-number">4.</span> <span class="nav-text">推荐阅读</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Gang Li</p>
  <div class="site-description" itemprop="description">微信公众号: PyStaData</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gang Li</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>

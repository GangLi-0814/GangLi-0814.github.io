<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="2020.10.26❤️🐱 📝💻🏸️🏃🏊"><title>违背经典假设的模型（一）：异方差 | LG's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><script class="js-hypothesis-config" type="application/json">{"showHighlights": true}</script><script src="https://hypothes.is/embed.js" async=""></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.0.2"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">违背经典假设的模型（一）：异方差</h1><a id="logo" href="/.">LG's Blog</a><p class="description">任尔东西南北风</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tag/"><i class="fa fa-tag"> 标签</i></a><a href="/foodie/"><i class="fa fa-heart"> 菜谱</i></a><a href="/shuoshuo/"><i class="fa fa-cloud"> 便签</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">违背经典假设的模型（一）：异方差</h1><div class="post-meta">2021-04-09<span> | </span><span class="category"><a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 4.3k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 17</span><span class="post-meta-item-text"> 分钟</span></span></span></div><a class="disqus-comment-count" href="/2021/04/09/Econometrics-heteroskedasticity/#vcomment"><span class="valine-comment-count" data-xid="/2021/04/09/Econometrics-heteroskedasticity/"></span><span> 条评论</span></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%96%B9%E5%B7%AE%E7%9A%84%E5%90%8E%E6%9E%9C"><span class="toc-number">1.</span> <span class="toc-text">异方差的后果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%96%B9%E5%B7%AE%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">2.</span> <span class="toc-text">异方差的例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%96%B9%E5%B7%AE%E7%9A%84%E6%A3%80%E9%AA%8C"><span class="toc-number">3.</span> <span class="toc-text">异方差的检验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%BB%E6%AE%8B%E5%B7%AE%E5%9B%BE"><span class="toc-number">3.1.</span> <span class="toc-text">画残差图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BP-%E6%A3%80%E9%AA%8C%EF%BC%88Breusch-and-Pagan-1979%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">BP 检验（Breusch and Pagan, 1979）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%80%E7%89%B9%E6%A3%80%E9%AA%8C%EF%BC%88White-1980%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">怀特检验（White, 1980）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%96%B9%E5%B7%AE%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">异方差的处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E2%80%9C-OLS-%E7%A8%B3%E5%81%A5%E6%A0%87%E5%87%86%E8%AF%AF%E2%80%9D"><span class="toc-number">4.1.</span> <span class="toc-text">使用“ OLS + 稳健标准误”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E6%9D%83%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95%EF%BC%88WLS%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">加权最小二乘法（WLS）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E8%A1%8C%E5%8A%A0%E6%9D%83%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95%EF%BC%88FWLS%EF%BC%89"><span class="toc-number">4.3.</span> <span class="toc-text">可行加权最小二乘法（FWLS）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%B6%E7%AB%9F%E4%BD%BF%E7%94%A8%E2%80%9C-OLS-%E7%A8%B3%E5%81%A5%E6%A0%87%E5%87%86%E8%AF%AF%E2%80%9D%E8%BF%98%E6%98%AF-FWLS-%EF%BC%9F"><span class="toc-number">4.4.</span> <span class="toc-text">究竟使用“ OLS + 稳健标准误”还是 FWLS ？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%BC%82%E6%96%B9%E5%B7%AE%E7%9A%84-Stata-%E5%91%BD%E4%BB%A4%E5%8F%8A%E5%AE%9E%E4%BE%8B"><span class="toc-number">5.</span> <span class="toc-text">处理异方差的 Stata 命令及实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stata-%E5%91%BD%E4%BB%A4%E7%9A%84%E6%89%B9%E5%A4%84%E7%90%86"><span class="toc-number">6.</span> <span class="toc-text">Stata 命令的批处理</span></a></li></ol></div></div><div class="post-content"><p><strong>“条件异方差”</strong>（简称“异方差”）是违背球型扰动假设的一种情形，即条件方差依赖于 i ，而不是常数 。</p>
<a id="more"></a>
<h3 id="异方差的后果"><a href="#异方差的后果" class="headerlink" title="异方差的后果"></a>异方差的后果</h3><p>在异方差的情况下：</p>
<ul>
<li>OLS 估计量依然无偏、一致且渐进正态。因为在证明这些性质时，未用到“同方差”的假定；</li>
<li>OLS 估计量方差 $Var(\hat \beta|X)$ 的表达式不再是 $\sigma^2(X’X)^{-1}$ ，因为 $Var(\epsilon|X) \neq \sigma^2I$ 。<strong>使用普通标准误的 t 检验、F 检验失效。</strong></li>
<li>高斯-马尔可夫定理不再成立，OLS 不再是 BLUE 。</li>
</ul>
<hr>
<p>【总结】异方差的后果</p>
<ol>
<li>$\beta$ 估计量无偏：用 OLS估计所得参数估计量 $\hat \beta$ 仍具有无偏性，即 $E(\hat \beta) = \beta$ 。 </li>
<li>$\beta$ 估计量非有效：存在异方差时，$\hat \beta_{OLS}$ 不是 $\beta$ 的有效估计；直接计算 $Se(\hat \beta)$ 有误 。</li>
<li>t 检验、F 检验失效。</li>
</ol>
<hr>
<p>【举例】考虑一元回归 $y_i = \alpha + \beta x_i + \epsilon$，假设 $Var(\epsilon_i | X)$ 是解释变量 $x_i$ 的增函数，即 $x_i$ 越大则 $Var(\epsilon_i|X)$ 越大。</p>
<p><img src="/2021/04/09/Econometrics-heteroskedasticity/7-1.png" style="zoom:70%"></p>
<p>OLS 回归线在 $x_i$ 较小时可以较精确地估计，而在 $x_i$ 较大时则难以准确估计。</p>
<p>方差较大的数据包含的信息量较小，但 OLS 却对所有数据等量齐观进行处理，故异方差的存在使得 OLS 的效率降低。</p>
<p>在异方差的情况下，加权最小二乘法（Weigthed Least Square，WLS）才是 BLUE 。WLS 通过对不同数据所包含信息量的不同进行相应的处理以提高估计效率。比如，给予信息量大的数据更大的权重。</p>
<h3 id="异方差的例子"><a href="#异方差的例子" class="headerlink" title="异方差的例子"></a>异方差的例子</h3><ul>
<li>（1）<strong>考虑消费函数：</strong></li>
</ul>
<script type="math/tex; mode=display">
c_i = \alpha + \beta y_i + \epsilon_i</script><p>其中，$c_i$ 为消费， $y_i$ 为收入。富人的消费计划较有弹性，而穷人的消费多为必需品，很少变动。富人的消费支出更难测量，包含较多测量误差。$Var(\epsilon_i|y_i)$ 可能随 $y_i$ 的上升而变大。</p>
<ul>
<li><p>（2）<strong>企业的投资、销售收入与利润：</strong>大型企业的商业活动可能动辄以亿元计，而小型企业则以万元计；因此，扰动项的规模也不相同。如将大、中、小型企业放在一起回归，可能存在异方差。</p>
</li>
<li><p>（3） <strong>组间异方差：</strong>如果样本包含两组（类）数据，则可能存在组内同方差，但组间异方差的情形。比如，第一组为自我雇佣者（企业主、个体户）的收入，而第二组为打工族的收入；自我雇佣者的收入波动可能比打工族更大。</p>
</li>
<li><p>（4） <strong>组平均数：</strong>如果数据本身就是组平均数，则大组平均数的方差通常要比小组平均数的方差小。比如，考虑全国各省的人均  GDP ，每个省一个数据。人口较多 的省份其方差较小，方差与人口数成反比。</p>
</li>
</ul>
<h3 id="异方差的检验"><a href="#异方差的检验" class="headerlink" title="异方差的检验"></a>异方差的检验</h3><h4 id="画残差图"><a href="#画残差图" class="headerlink" title="画残差图"></a>画残差图</h4><p>观察<strong>“残差 $e_i$ 与拟合值 $\hat y_i$ 的散点图”</strong>或者<strong>“残差 $e<em>i$ 与某个解释变量 $x</em>{ik}$ 的散点图”</strong>。画图是直观方法，但不严格。</p>
<p><img src="/2021/04/09/Econometrics-heteroskedasticity/7-0-1.png" style="zoom:70%"></p>
<p>（图片来源：古扎拉蒂《计量经济学基础》（第五版）, p.377）</p>
<p>上图中，图（a） 未发现两变量之间有任何系统性关系，图（b）到图（e）表明两变量呈现一定的关系。图（c）表示呈现线性关系，图（d）和图（e）表示 $\hat u_i^2$ 与 $\hat Y_i^2$ 呈现二次关系。<strong>利用图示虽然是非正式的方法，但是却有可能对数据进行变换，使变换后的数据不具有异方差性（如通过对数变换对原始数据进行压缩）。</strong></p>
<h4 id="BP-检验（Breusch-and-Pagan-1979）"><a href="#BP-检验（Breusch-and-Pagan-1979）" class="headerlink" title="BP 检验（Breusch and Pagan, 1979）"></a>BP 检验（Breusch and Pagan, 1979）</h4><p>假设回归模型：</p>
<script type="math/tex; mode=display">
y_i = \beta_1 + \beta_2x_{i2} + \cdots + \beta_Kx_{iK}+\epsilon_i</script><p>记 $X<em>i = \begin{matrix}(1 &amp; x</em>{i2} &amp; \cdots &amp; x_{iK}）\end{matrix}$ 。</p>
<p><strong>假设样本数据为 iid</strong> ，则 </p>
<script type="math/tex; mode=display">
Var(\epsilon_i |X)= Var(\epsilon_i|X_i)</script><p>“条件同方差”的原假设为：</p>
<script type="math/tex; mode=display">
H_0: Var(\epsilon_i|X_i) = \sigma^2</script><p>由于</p>
<script type="math/tex; mode=display">
Var(\epsilon_i|X_i) = E(\epsilon_{i}^2|X_i)-[\underbrace{E(\epsilon_i|X_i)}_{=0}]^2=E(\epsilon_i^2|X_i)</script><p> 原假设可写为：</p>
<script type="math/tex; mode=display">
H_0: E(\epsilon_i^2|X_i) = \sigma_i^2</script><p><strong>如果 $H_0$ 不成立</strong>，则条件方差 $E(\epsilon_i^2|X_i)$ 是 $X_i$ 的函数，称为“条件方差函数”（conditional variance function）。</p>
<p>假设此条件方差函数为线性函数：</p>
<script type="math/tex; mode=display">
\epsilon_i^2 = \delta_1+\delta_2x_{i2}+\cdots+\delta_Kx_{iK} + u_i</script><p>故原假设可以简化为：</p>
<script type="math/tex; mode=display">
H_0: \delta_2 = \cdots=\delta_K=0</script><p>由于扰动项 $\epsilon_i$ 不可观测，故使用残差平方和 $e_i^2$ 替代，进行辅助回归（auxiliary regression）：</p>
<script type="math/tex; mode=display">
e_i^2 = \delta_1 + \delta_2x_{i2} + \cdots+\delta_Kx_{iK} + error_{i}</script><p><strong>记此辅助回归的拟合优度为 $R^2$ 。$R^2$ 越高，则辅助回归方程越显著，越可拒绝 $H_0: \delta_2 = \cdots=\delta_K=0$ 。</strong></p>
<p>Breusch and pagan(1979) 使用 LM 统计量，进行 LM 检验（Lagrange Multiplier Test）：</p>
<script type="math/tex; mode=display">
LM = n R^2 \stackrel{d}{\rightarrow} \chi^2(K-1)</script><p>如果 LM 大于 $\chi^2(K-1)$ 的临界值，则拒绝同方差的原假设。</p>
<hr>
<p>【问题】为什么 LM 统计量是 $nR^2$ 呢?</p>
<p><strong>在大样本中，$nR^2$ 与检验整个方程显著性的 F 统计量渐近等价。</strong></p>
<p>首先，对于辅助回归，检验原假设 $H_0: \delta_2 = \cdots=\delta_K=0$ 的 F 统计量：</p>
<script type="math/tex; mode=display">
F =\frac{R^2/(K-1)}{(1-R^2)/(n-K)} \sim F(K-1,n-K)</script><p>其次，在大样本情况下，F 分布与 $\chi^2$ 分布是等价的。即：</p>
<script type="math/tex; mode=display">
(K-1)F = \frac{(n-K)R^2}{(1-R^2)} \stackrel{d}{\rightarrow} \chi^2(K-1)</script><p>在原假设 $H_0: \delta_2 = \cdots=\delta_K=0$ 成立的情况下，辅助回归方程常数项回归，故：</p>
<p>当 $n \rarr \infin$ 时，$R^2 \stackrel{p}{\rightarrow} 0$，而 $ (1-R^2) \stackrel{p}{\rightarrow} 1 $  。</p>
<p>因此：</p>
<script type="math/tex; mode=display">
(K-1)F = \frac{(n-K)R^2}{(1-R^2)} \stackrel{p}{\rightarrow} (n-K)R^2</script><p>在大样本下，$(n-K)R^2$ 与 $nR^2$ 并无差别，故 LM 检验与 F 检验渐近等价。</p>
<hr>
<p>如果认为异方差主要依赖被解释变量拟合值 $\hat y_i$ ，可将辅助回归改为：</p>
<script type="math/tex; mode=display">
e_i^2 = \delta_1 +\delta_2 \hat y_i + error_i</script><p>然后检验 $H_0: \delta_2 = 0$ （可使用 F 或 LM 统计量）。</p>
<p><strong>Breusch and pagan(1979) 的最初检验假设扰动项 $\epsilon_i$ 服从正态分布，有一定的局限性。</strong>Koenker(1981) 将此假定减弱为 iid ，使得 BP 检验在实际中较多采用。</p>
<hr>
<p>【总结】BP 检验步骤（伍德里奇《计量经济学导论》（第五版）p.225）</p>
<ol>
<li><p>使用 OLS 估计原模型 $y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_kx_k + u$，得到OLS 残差平方 $\hat u^2$ （每次观测得到一个）。</p>
</li>
<li><p>做 </p>
<script type="math/tex; mode=display">
\hat u^2 = \delta_0 + \delta_1 x_1 + \delta_2 x_2 + \cdots + \delta_k x_k + 误差</script><p>回归，记下此回归的 $R^2 \rarr R_{\hat u ^2}^2$ 。</p>
</li>
<li><p>计算 F 统计量或者 LM 统计量并计算 p 值。（前者使用 $F_{k, n-k-1}$ 分布，后者使用 $\chi_k^2$ 分布）。<strong>如果这个 p 值很小，即低于选定的显著性水平，那么就拒绝同方差性的原假设。</strong></p>
</li>
</ol>
<p>如果 BP 检验得到一个足够小的 p 值，那么就应该采取修正措施，使用异方差-稳健标准误，或者 WLS 。</p>
<hr>
<h4 id="怀特检验（White-1980）"><a href="#怀特检验（White-1980）" class="headerlink" title="怀特检验（White, 1980）"></a>怀特检验（White, 1980）</h4><p>BP 检验假设<strong>条件方差函数为线性函数</strong>，可能忽略了高次项。</p>
<p>怀特检验(White, 1980)在 BP 检验的辅助回归中<strong>加入所有的二次项（含平方项与交叉项）</strong>。</p>
<p>考虑以下二元回归：</p>
<script type="math/tex; mode=display">
y_i = \beta_1 + \beta_2 x_{i2} + \beta_3 x_{i3} + \epsilon_i</script><p>除常数项外，只有 $x<em>{i2}$ 和 $x</em>{i3}$ 两个解释变量，故二次项包括 $x<em>{i2}^2$ ，$x</em>{i3}^2$ 与 $x<em>{i2}x</em>{i3}$ 。</p>
<p>怀特检验的辅助回归为：</p>
<script type="math/tex; mode=display">
e_i^2 = \delta_1 + \delta_2x_{i2} + \delta_3 x_{i3} + \delta_4 x_{i2}^2 + \delta_5x_{i3}^2 + \delta_6x_{i2}x_{i3} + error_{i}</script><p>其中，$e_i^2$ 为二元回归方程的残差平方。</p>
<p>对原假设 $H_0: \delta_2 = \cdots=\delta_6=0$ 进行 F 检验或 LM 检验。</p>
<p>怀特检验可以检验任何形式的异方差；因为根据泰勒展开式，二次函数可很好地逼近任何光滑函数。</p>
<p>如果解释变量较多，则解释变量的二次项（含交叉项）将更多，在辅助回归中将损失较多样本容量。</p>
<h3 id="异方差的处理"><a href="#异方差的处理" class="headerlink" title="异方差的处理"></a>异方差的处理</h3><h4 id="使用“-OLS-稳健标准误”"><a href="#使用“-OLS-稳健标准误”" class="headerlink" title="使用“ OLS + 稳健标准误”"></a>使用“ OLS + 稳健标准误”</h4><p><strong>如发现异方差，一种处理方法是，仍进行 OLS 回归（OLS 依然无偏、一致且渐近正态），但使用在异方差情况下也成立的稳健标准误。这是最简单，也是目前通用的方法。</strong></p>
<p>只要样本容量较大，即使在异方差的情况下，只要使用稳健标准误，则所有参数估计、假设检验均可照常进行。</p>
<hr>
<p>【补充】何谓“稳健标准误”？（伍德里奇《计量经济学导论》（第五版）p.219）</p>
<p>在一般多元回归模型：</p>
<script type="math/tex; mode=display">
y = \beta_0 + \beta_1x_1 + \beta_2 x_2 + \cdots + \beta_k x_k + u</script><p>在假定 MLR.1~MLR.4 下，$Var(\hat \beta_j)$ 的一个有效估计量是：</p>
<script type="math/tex; mode=display">
\hat{Var(\hat \beta_j)} = \frac{\sum_{i=1}^n \hat r_{ij}^2 \hat u_i^2}{SSR_j^2}</script><p>其中，$\hat r_{ij}^2$ 表示将 $x_j$ 对所有其他自变量做回归所得到的第 $i$ 个残差，而 $SSR_j$ 则是这个回归的残差平方和。上式的<strong>平方根</strong>被称为 $\hat \beta_j^2$ 的异方差-稳健标准误（heteroskedasticity-robust standard error）。 </p>
<hr>
<h4 id="加权最小二乘法（WLS）"><a href="#加权最小二乘法（WLS）" class="headerlink" title="加权最小二乘法（WLS）"></a>加权最小二乘法（WLS）</h4><p>方差较小的观测值包含的信息量较大。对于异方差的另一处理方法是，给予方差较小的观测值较大的权重，然后进行加权最小二乘法估计。</p>
<p><strong>WLS 的基本思想是：通过变量转换，使得变换后的模型满足球形扰动项的假定（变为同方差），然后进行 OLS 估计，即为最有效率的 BLUE 。</strong></p>
<p>考虑线性回归模型：</p>
<script type="math/tex; mode=display">
y_i = \beta_1 + \beta_2x_{i2} + \cdots+\beta_K x_{iK} + \epsilon_i</script><p>假定 $Var(\epsilon<em>i|x_i) \equiv \sigma_i^2 = \sigma_i^2v_i$ ，且 ${v_i}</em>{i=1}^n$ 已知。</p>
<p>两边同乘权重 $1/\sqrt{v_i}$ 可得：</p>
<script type="math/tex; mode=display">
\frac{y_i}{\sqrt{v_i}} = \beta_1\frac{1}{\sqrt{v_i}} + \beta_2\frac{x_{i2}}{\sqrt{v_i}} + \cdots+\beta_K \frac{x_{iK}}{\sqrt{v_i}} + \frac{\epsilon_i}{\sqrt{v_i}}</script><p>新扰动项 $\epsilon_i/\sqrt{v_i}$ 不再有异方差，因为：</p>
<script type="math/tex; mode=display">
Var(\epsilon_i/\sqrt{v_i}) = \frac{1}{v_i}Var(\epsilon_i) = \frac{\sigma^2v_i}{v_i} = \sigma^2</script><p>对<strong>乘以权数后的方程</strong>进行 OLS 回归，即为 WLS 。</p>
<p>加权之后的回归方程满足球形扰动项的假定，故是 BLUE 。</p>
<p>可将 WLS 定义为最小化“加权残差平方和”，即：</p>
<script type="math/tex; mode=display">
\min \quad \sum_{i=1}^n (e_i/\sqrt{v_i})^2 = \sum_{i=1}^n \frac{e_i^2}{v_i}</script><p>权重为 $1/v_i$ （即方差的倒数）（ Stata 也是如此约定）。</p>
<p>WLS 的 $R^2$ 通常没有太大的意义，它衡量的是变换之后的解释变量 $(x_{ik}/\sqrt{v_i})$  对变换之后的被解释变量 $(y_i/\sqrt{v_i})$ 的解释力。</p>
<h4 id="可行加权最小二乘法（FWLS）"><a href="#可行加权最小二乘法（FWLS）" class="headerlink" title="可行加权最小二乘法（FWLS）"></a>可行加权最小二乘法（FWLS）</h4><p>使用 WLS 虽然可以得到 BLUE 估计，但是必须知道每位个体的方差，即 ${\sigma<em>i^2}</em>{i=1}^n$ 。实践中通常不知道 ${\sigma<em>i^2}</em>{i=1}^n$ ，故 WLS 事实上是不可行（infeasible）的。</p>
<p><strong>解决办法：先用样本数据估计 ${\sigma<em>i^2}</em>{i=1}^n$ ，然后再使用 WLS ，称为 “可行加权最小二乘法” （Feasible WLS，简称 FWLS ）。</strong></p>
<p>在进行 BP 检验时，进行如下辅助回归：</p>
<script type="math/tex; mode=display">
e_i^2 = \delta_1 + \delta_2x_{i2} + \cdots + \delta_K x_{iK} + error_i</script><p>其中，$e_i^2$ 为原方程的残差平方。</p>
<p>通过辅助回归的拟合值，可得 $\sigma_i^2$ 的估计值：</p>
<script type="math/tex; mode=display">
\sigma_i^2 = \hat \delta_1 + \hat \delta_2 x_{i2} + \cdots + \hat \delta_K x_{iK}</script><p>但可能出现 $\hat \sigma_i^2 &lt; 0$ 的情形，而方差不能为负。</p>
<p>为保证 $\hat \sigma_i^2 &gt; 0$，假设条件方差函数为对数形式：</p>
<script type="math/tex; mode=display">
\ln{e_i^2} = \delta_1 + \delta_2x_{i2} + \cdots + \delta_kx_{iK} + error_i</script><p>对此方程进行 OLS 回归，可得 $\ln{e_i^2}$ 的预测值，记为 $\ln{\hat \sigma_i^2}$ 。</p>
<p><strong>得到拟合值 $\hat \sigma_i^2 = exp(\ln{\hat \sigma_i^2})$ （一定为正）。</strong></p>
<p><strong>以 $1/\hat \sigma<em>i^2$ 为权重对原方程进行 WLS 估计，记此估计量为 $\hat \beta</em>{FWLS}$ 。</strong></p>
<h4 id="究竟使用“-OLS-稳健标准误”还是-FWLS-？"><a href="#究竟使用“-OLS-稳健标准误”还是-FWLS-？" class="headerlink" title="究竟使用“ OLS + 稳健标准误”还是 FWLS ？"></a>究竟使用“ OLS + 稳健标准误”还是 FWLS ？</h4><p>理论上，WLS 是 BLUE 。</p>
<p>实践中的 FWLS 并非线性估计，因为权重 $1/\hat \sigma_i^2$ 也是 $y$ 的函数。</p>
<p>由于 $\hat \beta<em>{FWLS}$ 是 $y$ 的非线性函数，一般有偏。$\hat \beta</em>{FWLS}$ 无资格参加 BLUE 的评选。</p>
<p>FWLS 的优点主要体现在大样本中。如果 $\hat \sigma_i^2$ 是 $\sigma_i^2$ 的一致估计，则 FWLS 一致，且在大样本下比 OLS 更有效率。</p>
<p>FWLS的缺点是必须估计条件方差函数 $\hat \sigma_i^2(x_i)$ ，而通常不知道条件方差函数的具体形式。如果该函数的形式设定不正确，根据 FWLS 计算的标准误可能失效，导致不正确的统计推断。</p>
<p>使用“ OLS + 稳健标准误”的好处是，对回归系数及标准误的估计都一致，不需要知道条件方差函数的形式。而且在 Stata 中的操作简单，在 <code>reg</code> 之后添加 <code>robust</code> 选项即可。</p>
<p><strong>“ OLS + 稳健标准误”更为稳健（适用于一般的情形），而 FWLS 更有效率。</strong></p>
<p>Stock and Watson (2012)推荐，在大多数情况下应使用“OLS + 稳健标准误”。但 Wooldridge(2009) 指出，如果存在严重的异方差，可通过 FWLS 提高估计效率。</p>
<p>如果对于条件异方差函数的具体形式没有把握，不知道经过加权处理之后的新扰动项 $\epsilon_i/\sqrt{v_i}$ 是否同方差，可在 WLS 回归时仍使用异方差稳健标准误，以保证 FWLS 标准误的有效性。</p>
<p>如果被解释变量取值为正，有时将被解释变量取对数，可以缓解异方差问题。</p>
<h3 id="处理异方差的-Stata-命令及实例"><a href="#处理异方差的-Stata-命令及实例" class="headerlink" title="处理异方差的 Stata 命令及实例"></a>处理异方差的 Stata 命令及实例</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="variable">$&#123;d&#125;</span>/nerlove.dta, <span class="keyword">clear</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">数据说明：此数据集包括以下变量:tc (总成本)，q (总产量)，pl (工资率)， pk (资本的使用成本) 与 pf (燃料价格)，以及相应的对数值 lntc， lnq，lnpl，lnpk 与 lnpf。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">reg</span> lntc lnq lnpl lnpk lnpf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 1.残差图 -rvfplot- (residual-versus-fitted plot)</span></span><br><span class="line"><span class="keyword">rvfplot</span> <span class="comment">//残差与拟合值的散点图</span></span><br><span class="line"><span class="keyword">rvpplot</span> lnq <span class="comment">// 残差与解释变量 lnq 的散点图</span></span><br><span class="line"></span><br><span class="line"><span class="comment">* 2.BP 检验</span></span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">hettest</span>, iid rhs </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">其中：</span></span><br><span class="line"><span class="comment">- “estat”指 post-estimation statistics(估计后统计量)，即在完成估计后所计算的后续统计量。 </span></span><br><span class="line"><span class="comment">- “hettest”表示 heteroskedasticity test。</span></span><br><span class="line"><span class="comment">- 选择项“iid”表示仅假定数据为 iid，而无须正态假定。</span></span><br><span class="line"><span class="comment">- 选择项“rhs”表示，使用方程右边的全部解释变量进行辅助回 归，默认使用拟合值 yˆ 进行辅助回归。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">estat hettest [varlist], iid //指定使用 varlist 进行辅助回归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">quietly</span> <span class="keyword">reg</span> lntc lnq lnpl lnpk lnpf</span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">hettest</span>, iid  <span class="comment">// 使用拟合值进行 BP 检验</span></span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">hettest</span>, iid rhs <span class="comment">// 使用所有解释变量进行 BP 检验</span></span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">hettest</span> lnq, iid <span class="comment">// 使用变量 lnq 进行 BP 检验</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">结果解读：</span></span><br><span class="line"><span class="comment">各种形式 BP 检验的 p 值都等于 0.0000，故强烈拒绝同方差的原 假设，认为存在异方差。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">* 3.怀特检验</span></span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">imtest</span>, white <span class="comment">// imtest:  information matrix test(信息矩阵检验)</span></span><br><span class="line"><span class="comment">/*结果解读：</span></span><br><span class="line"><span class="comment">p值(Prob&gt;chi2)等于 0.0000，强烈拒绝同方差的原假设，认 为存在异方差。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">* 4.WLS</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">得到扰动项方差的估计值 $&#123;\hat \sigma_&#123;i&#125;^2&#125;_&#123;i=1&#125;^n$ 后，可作为权重进行 WLS 估计。 假设已把 $&#123;\hat \sigma_&#123;i&#125;^2&#125;_&#123;i=1&#125;^n$ 存储在变量 var 上，可通过如下 Stata 命令来实现 WLS ：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">reg y x1 x2 x3 [aw=1/var]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">其中，“aw”表示 analytical weight，为扰动项方差(不是标准差)的倒数。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">quietly</span> <span class="keyword">reg</span> lntc lnq lnql lnpk lnpf</span><br><span class="line"><span class="keyword">predict</span> e1, residual</span><br><span class="line"><span class="keyword">gen</span> e2 = e1^2</span><br><span class="line"><span class="keyword">gen</span> lne2 = <span class="built_in">log</span>(e2)</span><br><span class="line"><span class="keyword">reg</span> lne2 lnq <span class="comment">// 假设 $\ln&#123;\hat \sigma_&#123;i&#125;^2&#125;$ 为变量 `lnq&#x27; 的线性函数进行辅助回归</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">结果解读：变量lnq在1%水平上显著，但R2仅为0.1309，且常数项不显著 ( p值为 0.26)。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">reg</span> lne2 lnq, noc <span class="comment">//去掉常数项重新进行辅助回归</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">结果解读：</span></span><br><span class="line"><span class="comment">R2上升为 0.7447(尽管无常数项的R2与有常数项的R2不可比)， 残差平方的变动与 lnq 高度相关。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">predict</span> lne2f <span class="comment">// 计算辅助回归的拟合值</span></span><br><span class="line"><span class="keyword">gen</span> e2f = <span class="built_in">exp</span>(lne2f) <span class="comment">//去掉对数后，即得到方差的估计值</span></span><br><span class="line"><span class="keyword">reg</span> lntc lnq lnpl lnpk lnpf [aw=1/e2f] <span class="comment">// 使用方差估计值的倒数作为权重,WLS</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">结果解读：</span></span><br><span class="line"><span class="comment">WLS 回归的结果显示，lnpk 的系数估计值由“-0.22”(OLS 估 计值)改进为“-0.09”(其理论值应为正数)。</span></span><br><span class="line"><span class="comment">使用 OLS 时，变量 lnpl 的 p 值为 0.13，在 10%的水平上也不显 著;使用 WLS 后，该变量的 p 值变为 0.002，在 1%的水平上显著 不为 0。</span></span><br><span class="line"><span class="comment">由于 Nerlove(1963)数据存在明显的异方差，使用 WLS 后提高了 估计效率。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">如担心条件方差函数的设定不准确，导致加权后的新扰动项仍 有异方差，可使用稳健标准误进行 WLS 估计:</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">reg</span> lntc lnq lnpl lnpk lnpf [aw=1/e2f],r</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">结果解读：</span></span><br><span class="line"><span class="comment">无论是否使用稳健标准误，WLS 的回归系数都相同，但标准误有所不同。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h3 id="Stata-命令的批处理"><a href="#Stata-命令的批处理" class="headerlink" title="Stata 命令的批处理"></a>Stata 命令的批处理</h3><p>do文档的使用</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* WLS for Nerlove(1963)</span></span><br><span class="line"><span class="keyword">capture</span> <span class="keyword">log</span> <span class="keyword">close</span></span><br><span class="line"><span class="keyword">log</span> using wls_nerlove,<span class="keyword">replace</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">more</span> off</span><br><span class="line"><span class="keyword">use</span> nerlove.dta, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">reg</span> lntc lnq lnpl lnpk lnpf</span><br><span class="line"><span class="keyword">predict</span> e1,r</span><br><span class="line"><span class="keyword">gen</span> e2=e1^2</span><br><span class="line"><span class="keyword">gen</span> lne2=<span class="built_in">log</span>(e2)</span><br><span class="line"><span class="keyword">reg</span> lne2 lnq,noc</span><br><span class="line"><span class="keyword">predict</span> lne2f</span><br><span class="line"><span class="keyword">gen</span> e2f=<span class="built_in">exp</span>(lne2f)</span><br><span class="line"></span><br><span class="line"><span class="comment">* Weighted least square regression</span></span><br><span class="line"><span class="keyword">reg</span> lntc lnq lnpl lnpk lnpf [aw=1/e2f]</span><br><span class="line"><span class="keyword">reg</span> lntc lnq lnpl lnpk lnpf [aw=1/e2f],r</span><br><span class="line"><span class="keyword">log</span> <span class="keyword">close</span></span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>
</div><div id="donate"><link rel="stylesheet" type="text/css" href="/css/donate.css"><script type="text/javascript" src="/js/donate.js" successtext="复制成功!"></script><a class="pos-f tr3" id="github" target="_blank" rel="noopener" href="https://github.com/Kaiyuan/donate-page" arget="_blank" title="Github"></a><div id="DonateText">Donate</div><ul class="list pos-f" id="donateBox"><li id="AliPay" qr="/img/alipayQR.jpg"></li><li id="WeChat" qr="/img/wechatQR.jpg"></li></ul><div class="pos-f left-100" id="QRBox"><div id="MainBox"></div></div></div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css"><p><span>本文标题：</span>违背经典假设的模型（一）：异方差</p><p><span>文章作者：</span>Gang Li</p><p><span>发布时间：</span>2021-04-09</p><p><span>最后更新：</span>2021-04-13</p><p><span>原始链接：</span><a href="/2021/04/09/Econometrics-heteroskedasticity/">http://lgspace.top/2021/04/09/Econometrics-heteroskedasticity/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="http://lgspace.top/2021/04/09/Econometrics-heteroskedasticity/"></i></span></p><p><span>版权声明：</span>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</p></div><br><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="http://lgspace.top/2021/04/09/Econometrics-heteroskedasticity/" data-id="cktjvhcle00ae8cor1ynyhx40" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACL0lEQVR42u3awW7rMAwEwP7/T7vAu7Z2dsX0AZFGp8CVI00OLCnq6yse17/x/PznnOtm/Pzr3ZM3DwwMjI9lXI8jWeAO8Pzu3Zzn57c7wcDAOICRBNNkmTwe5kE5+geAgYGB8Tin3VabLGJgYGC0jORzG7gxMDAwEkaborXBNN/un9fiGBgYH8hoGwP/8/Mf9jcwMDA+hHGVo21zztsD0a4wMDC2ZiRH9msheO3dNroWnQcMDIyNGGuXvd57LWztIA8DA2NXxnOiNolm7WWLFo+BgXEOoy0+19oAUQNy3GzAwMDYlZEEvknQTLbehu/bU0MMDIxNGW2QbWdOUr38+gUGBsbejMkp3aQ9mbcQohQTAwPjAEZbps63spb81XdGMDAwNmVMDuDaLc6vcWBgYJzGSMrOCbg9w8/LYwwMjL0Za9cp8uZlMrMtdF8U2xgYGFszkrZl+zy/Lpb/WFHBjIGBsREjOdJKNtGG6fllCwwMjHMYk4WTJds0Md/VL6tjYGBsypgkcGtBNm8kFO9iYGAcxmiTubxhMCmVX6StGBgYWzPWStPnL60Xi1PM+gQRAwNjC8ZVjrWUMQHnP9CL1BADA2M7Rj7yUrMNmsW5YNlCwMDA2ImRBNm83G3nzGdiYGCcw1i7vZAnlO9K8l5cDsPAwDiekZSd8/bn2jEfBgYGRnuU1n5D3vjEwMA4mbFWxLaXM/J2aZ6MYmBgnMBoGwOTnkOy/HuvcWBgYHw44xvxQ4SabS0MAgAAAABJRU5ErkJggg==">分享</a><div class="tags"><a href="/tags/%E8%AE%A1%E9%87%8F/"><i class="fa fa-tag"></i>计量</a></div><div class="post-nav"><a class="pre" href="/2021/04/13/English-PhD/">考博英语笔记</a><a class="next" href="/2021/04/08/Stata-get-Uncomtrade-data/">批量获取 Uncomtrade 数据</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == 'true' ? true : false;
var verify = 'false' == 'true' ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'4r3jOS497uyoVjem8hrofuye-MdYXbMMI',
  appKey:'dRzNUi4hOYKfUV95GTwK8hoH',
  placeholder:'给我留言吧～',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'7'
})
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"/><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script><div class="aplayer" data-id="5305796974" data-server="netease" data-type="playlist" data-listmaxheight="98px" data-theme="#555555"></div></div><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a><span class="category-list-count">70</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a><span class="category-list-count">11</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/%E5%BE%AE%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">微观经济学</a> <a href="/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">课程笔记</a> <a href="/tags/HUST/" style="font-size: 15px;">HUST</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Stata/" style="font-size: 15px;">Stata</a> <a href="/tags/%E6%95%B0%E6%8D%AE/" style="font-size: 15px;">数据</a> <a href="/tags/Casual-Inference/" style="font-size: 15px;">Casual Inference</a> <a href="/tags/%E6%96%87%E7%8C%AE/" style="font-size: 15px;">文献</a> <a href="/tags/Data/" style="font-size: 15px;">Data</a> <a href="/tags/%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">经济学</a> <a href="/tags/%E5%8F%91%E5%B1%95%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">发展经济学</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">笔记</a> <a href="/tags/%E8%AE%A1%E9%87%8F/" style="font-size: 15px;">计量</a> <a href="/tags/English/" style="font-size: 15px;">English</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 15px;">工具</a> <a href="/tags/%E6%96%87%E4%BB%B6/" style="font-size: 15px;">文件</a> <a href="/tags/IELTS/" style="font-size: 15px;">IELTS</a> <a href="/tags/Notes/" style="font-size: 15px;">Notes</a> <a href="/tags/%E5%AE%8F%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">宏观经济学</a> <a href="/tags/%E5%8F%B6%E8%88%AA/" style="font-size: 15px;">叶航</a> <a href="/tags/Jupyter-Notebook/" style="font-size: 15px;">Jupyter Notebook</a> <a href="/tags/Mankin/" style="font-size: 15px;">Mankin</a> <a href="/tags/%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6/" style="font-size: 15px;">计量经济学</a> <a href="/tags/%E5%8C%97%E4%BA%AC/" style="font-size: 15px;">北京</a> <a href="/tags/%E7%94%B5%E5%BD%B1/" style="font-size: 15px;">电影</a> <a href="/tags/%E8%A7%82%E5%90%8E%E6%84%9F/" style="font-size: 15px;">观后感</a> <a href="/tags/Zotero/" style="font-size: 15px;">Zotero</a> <a href="/tags/%E6%83%B3%E6%B3%95/" style="font-size: 15px;">想法</a> <a href="/tags/%E6%97%85%E8%A1%8C/" style="font-size: 15px;">旅行</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 15px;">加密</a> <a href="/tags/%E7%BE%8E%E9%A3%9F/" style="font-size: 15px;">美食</a> <a href="/tags/LaTeX/" style="font-size: 15px;">LaTeX</a> <a href="/tags/%E4%BF%A1%E5%8F%A3%E8%83%A1%E8%AF%8C/" style="font-size: 15px;">信口胡诌</a> <a href="/tags/%E8%8B%B1%E8%AF%AD/" style="font-size: 15px;">英语</a> <a href="/tags/%E8%80%83%E5%8D%9A/" style="font-size: 15px;">考博</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/09/23/MacroEcon-Data-Sources/">宏观经济常用数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/14/Advanced-MicroEcon-Notes-1/">高级微观经济学II课程笔记（1）</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/19/Guide-to-Writing-in-Economics/">Guide to Writing in Economics</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/28/Exporting-Data-from-PDFs/">从 PDF 文件提取文本内容</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/22/Markdown-Typora-Brief-Intro/">Markdown-Typora-Brief-Intro</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/MacroEcon-Mankin-DynamicAD-AS/">MacroEcon-Mankin-DynamicAD-AS</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/20/DevelopEcon-ZhangPeiGang-Notes/">公平与发展</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/20/MacroEcon-Models/">MacroEcon-Models</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/20/MacroEcon-Mankin-Business-Cycle-Theory/">MacroEcon-Mankin-Business-Cycle-Theory</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/20/MacroEcon-Mankin-GrowthTheory/">增长理论：超长期中的经济</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://magi.com/" title="magi 搜索" target="_blank">magi 搜索</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">LG's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="0,0,0" opacity="0.5" zIndex="-2" count="50" src="//cdn.jsdelivr.net/npm/canvas-nest.js/dist/canvas-nest.min.js"></script><script type="text/javascript" src="/js/love.js"></script><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script><script>(function(d) {
  var config = {
    kitId: 'qpn2tap',
    scriptTimeout: 3000,
    async: true
  },
  h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
})(document);</script></div></body></html>